{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3d62e146",
   "metadata": {
    "_cell_guid": "e8842166-aa24-40c5-872b-68cd7a3752fa",
    "_uuid": "5884add2-f36a-41ea-81fe-ac91f3b33aa2",
    "collapsed": false,
    "execution": {
     "iopub.execute_input": "2025-01-03T00:24:56.792113Z",
     "iopub.status.busy": "2025-01-03T00:24:56.791637Z",
     "iopub.status.idle": "2025-01-03T00:25:02.972704Z",
     "shell.execute_reply": "2025-01-03T00:25:02.971296Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 6.18811,
     "end_time": "2025-01-03T00:25:02.974700",
     "exception": false,
     "start_time": "2025-01-03T00:24:56.786590",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Looking in indexes: https://download.pytorch.org/whl/cu118\r\n",
      "Requirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (2.4.1+cu121)\r\n",
      "Requirement already satisfied: torchvision in /usr/local/lib/python3.10/dist-packages (0.19.1+cu121)\r\n",
      "Requirement already satisfied: torchaudio in /usr/local/lib/python3.10/dist-packages (2.4.1+cu121)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch) (3.16.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch) (1.13.3)\r\n",
      "Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch) (2024.6.1)\r\n",
      "Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from torchvision) (1.26.4)\r\n",
      "Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.10/dist-packages (from torchvision) (10.4.0)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->torch) (1.3.0)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7ca6d0c0",
   "metadata": {
    "_cell_guid": "1d3ed487-fb09-4a8a-b794-3c0be606e629",
    "_uuid": "d6116496-ef3d-40f4-9d37-4732263e8980",
    "collapsed": false,
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:02.982853Z",
     "iopub.status.busy": "2025-01-03T00:25:02.982423Z",
     "iopub.status.idle": "2025-01-03T00:25:07.146536Z",
     "shell.execute_reply": "2025-01-03T00:25:07.145163Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 4.170239,
     "end_time": "2025-01-03T00:25:07.148584",
     "exception": false,
     "start_time": "2025-01-03T00:25:02.978345",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "!pip install stable-baselines3==2.1.0 pandas matplotlib plotly bokeh wandb shimmy>=1.2.1 gymnasium==0.29.0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "ab8d742e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:07.156533Z",
     "iopub.status.busy": "2025-01-03T00:25:07.156189Z",
     "iopub.status.idle": "2025-01-03T00:25:07.160478Z",
     "shell.execute_reply": "2025-01-03T00:25:07.159664Z"
    },
    "papermill": {
     "duration": 0.01016,
     "end_time": "2025-01-03T00:25:07.162172",
     "exception": false,
     "start_time": "2025-01-03T00:25:07.152012",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import warnings\n",
    "warnings.filterwarnings(\"ignore\", category=DeprecationWarning)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3f24ba5e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:07.169445Z",
     "iopub.status.busy": "2025-01-03T00:25:07.169136Z",
     "iopub.status.idle": "2025-01-03T00:25:07.173857Z",
     "shell.execute_reply": "2025-01-03T00:25:07.172751Z"
    },
    "papermill": {
     "duration": 0.010444,
     "end_time": "2025-01-03T00:25:07.175739",
     "exception": false,
     "start_time": "2025-01-03T00:25:07.165295",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5.5.6\n"
     ]
    }
   ],
   "source": [
    "import ipykernel\n",
    "print(ipykernel.__version__)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2a9fc54b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:07.183134Z",
     "iopub.status.busy": "2025-01-03T00:25:07.182835Z",
     "iopub.status.idle": "2025-01-03T00:25:19.798515Z",
     "shell.execute_reply": "2025-01-03T00:25:19.797341Z"
    },
    "papermill": {
     "duration": 12.62136,
     "end_time": "2025-01-03T00:25:19.800323",
     "exception": false,
     "start_time": "2025-01-03T00:25:07.178963",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/javascript": [
       "\n",
       "        (async () => {\n",
       "            const url = new URL(await google.colab.kernel.proxyPort(6006, {'cache': true}));\n",
       "            url.searchParams.set('tensorboardColab', 'true');\n",
       "            const iframe = document.createElement('iframe');\n",
       "            iframe.src = url;\n",
       "            iframe.setAttribute('width', '100%');\n",
       "            iframe.setAttribute('height', '800');\n",
       "            iframe.setAttribute('frameborder', 0);\n",
       "            document.body.appendChild(iframe);\n",
       "        })();\n",
       "    "
      ],
      "text/plain": [
       "<IPython.core.display.Javascript object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%load_ext tensorboard\n",
    "%tensorboard --logdir /kaggle/working/tensorboard_logs/\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "2159deb4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:19.808472Z",
     "iopub.status.busy": "2025-01-03T00:25:19.808126Z",
     "iopub.status.idle": "2025-01-03T00:25:19.812497Z",
     "shell.execute_reply": "2025-01-03T00:25:19.811291Z"
    },
    "papermill": {
     "duration": 0.010372,
     "end_time": "2025-01-03T00:25:19.814374",
     "exception": false,
     "start_time": "2025-01-03T00:25:19.804002",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import os\n",
    "os.environ[\"TF_CPP_MIN_LOG_LEVEL\"] = \"3\"\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "88b03976",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:19.822468Z",
     "iopub.status.busy": "2025-01-03T00:25:19.822128Z",
     "iopub.status.idle": "2025-01-03T00:25:40.920959Z",
     "shell.execute_reply": "2025-01-03T00:25:40.919533Z"
    },
    "papermill": {
     "duration": 21.105018,
     "end_time": "2025-01-03T00:25:40.922969",
     "exception": false,
     "start_time": "2025-01-03T00:25:19.817951",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: wandb in /usr/local/lib/python3.10/dist-packages (0.19.1)\r\n",
      "Collecting jupyter\r\n",
      "  Downloading jupyter-1.1.1-py2.py3-none-any.whl.metadata (2.0 kB)\r\n",
      "Requirement already satisfied: ipykernel in /usr/local/lib/python3.10/dist-packages (5.5.6)\r\n",
      "Collecting ipykernel\r\n",
      "  Downloading ipykernel-6.29.5-py3-none-any.whl.metadata (6.3 kB)\r\n",
      "Requirement already satisfied: click!=8.0.0,>=7.1 in /usr/local/lib/python3.10/dist-packages (from wandb) (8.1.7)\r\n",
      "Requirement already satisfied: docker-pycreds>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (0.4.0)\r\n",
      "Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (3.1.43)\r\n",
      "Requirement already satisfied: platformdirs in /usr/local/lib/python3.10/dist-packages (from wandb) (4.3.6)\r\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (3.20.3)\r\n",
      "Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (5.9.5)\r\n",
      "Requirement already satisfied: pydantic<3,>=2.6 in /usr/local/lib/python3.10/dist-packages (from wandb) (2.9.2)\r\n",
      "Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from wandb) (6.0.2)\r\n",
      "Requirement already satisfied: requests<3,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (2.32.3)\r\n",
      "Requirement already satisfied: sentry-sdk>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb) (2.19.2)\r\n",
      "Requirement already satisfied: setproctitle in /usr/local/lib/python3.10/dist-packages (from wandb) (1.3.4)\r\n",
      "Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from wandb) (71.0.4)\r\n",
      "Requirement already satisfied: typing-extensions<5,>=4.4 in /usr/local/lib/python3.10/dist-packages (from wandb) (4.12.2)\r\n",
      "Requirement already satisfied: notebook in /usr/local/lib/python3.10/dist-packages (from jupyter) (6.5.4)\r\n",
      "Requirement already satisfied: jupyter-console in /usr/local/lib/python3.10/dist-packages (from jupyter) (6.1.0)\r\n",
      "Requirement already satisfied: nbconvert in /usr/local/lib/python3.10/dist-packages (from jupyter) (6.4.5)\r\n",
      "Requirement already satisfied: ipywidgets in /usr/local/lib/python3.10/dist-packages (from jupyter) (8.1.5)\r\n",
      "Requirement already satisfied: jupyterlab in /usr/local/lib/python3.10/dist-packages (from jupyter) (3.6.8)\r\n",
      "Requirement already satisfied: comm>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (0.2.2)\r\n",
      "Requirement already satisfied: debugpy>=1.6.5 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (1.6.6)\r\n",
      "Requirement already satisfied: ipython>=7.23.1 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (7.34.0)\r\n",
      "Requirement already satisfied: jupyter-client>=6.1.12 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (8.6.3)\r\n",
      "Requirement already satisfied: jupyter-core!=5.0.*,>=4.12 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (5.7.2)\r\n",
      "Requirement already satisfied: matplotlib-inline>=0.1 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (0.1.7)\r\n",
      "Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.10/dist-packages (from ipykernel) (1.6.0)\r\n",
      "Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from ipykernel) (24.1)\r\n",
      "Requirement already satisfied: pyzmq>=24 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (24.0.1)\r\n",
      "Requirement already satisfied: tornado>=6.1 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (6.3.3)\r\n",
      "Requirement already satisfied: traitlets>=5.4.0 in /usr/local/lib/python3.10/dist-packages (from ipykernel) (5.7.1)\r\n",
      "Requirement already satisfied: six>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)\r\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.10/dist-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.11)\r\n",
      "Requirement already satisfied: jedi>=0.16 in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (0.19.2)\r\n",
      "Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (4.4.2)\r\n",
      "Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (0.7.5)\r\n",
      "Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (3.0.47)\r\n",
      "Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (2.18.0)\r\n",
      "Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (0.2.0)\r\n",
      "Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from ipython>=7.23.1->ipykernel) (4.9.0)\r\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from jupyter-client>=6.1.12->ipykernel) (2.8.2)\r\n",
      "Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from pydantic<3,>=2.6->wandb) (0.7.0)\r\n",
      "Requirement already satisfied: pydantic-core==2.23.4 in /usr/local/lib/python3.10/dist-packages (from pydantic<3,>=2.6->wandb) (2.23.4)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.0.0->wandb) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.0.0->wandb) (3.10)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.0.0->wandb) (2.2.3)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.0.0->wandb) (2024.8.30)\r\n",
      "Requirement already satisfied: widgetsnbextension~=4.0.12 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->jupyter) (4.0.13)\r\n",
      "Requirement already satisfied: jupyterlab-widgets~=3.0.12 in /usr/local/lib/python3.10/dist-packages (from ipywidgets->jupyter) (3.0.13)\r\n",
      "Requirement already satisfied: jupyterlab-server~=2.19 in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (2.27.3)\r\n",
      "Requirement already satisfied: jupyter-server<3,>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (2.12.5)\r\n",
      "Requirement already satisfied: jupyter-ydoc~=0.2.4 in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (0.2.5)\r\n",
      "Requirement already satisfied: jupyter-server-ydoc~=0.8.0 in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (0.8.0)\r\n",
      "Requirement already satisfied: nbclassic in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (1.1.0)\r\n",
      "Requirement already satisfied: jinja2>=2.1 in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (3.1.4)\r\n",
      "Requirement already satisfied: tomli in /usr/local/lib/python3.10/dist-packages (from jupyterlab->jupyter) (2.0.1)\r\n",
      "Requirement already satisfied: argon2-cffi in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (23.1.0)\r\n",
      "Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (0.2.0)\r\n",
      "Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (5.10.4)\r\n",
      "Requirement already satisfied: Send2Trash>=1.8.0 in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (1.8.3)\r\n",
      "Requirement already satisfied: terminado>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (0.18.1)\r\n",
      "Requirement already satisfied: prometheus-client in /usr/local/lib/python3.10/dist-packages (from notebook->jupyter) (0.20.0)\r\n",
      "Requirement already satisfied: mistune<2,>=0.8.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.8.4)\r\n",
      "Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.3.0)\r\n",
      "Requirement already satisfied: entrypoints>=0.2.2 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.4)\r\n",
      "Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (6.1.0)\r\n",
      "Requirement already satisfied: pandocfilters>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (1.5.1)\r\n",
      "Requirement already satisfied: testpath in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.6.0)\r\n",
      "Requirement already satisfied: defusedxml in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.7.1)\r\n",
      "Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (4.12.3)\r\n",
      "Requirement already satisfied: nbclient<0.6.0,>=0.5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (0.5.13)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert->jupyter) (2.1.5)\r\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.10/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.1)\r\n",
      "Requirement already satisfied: parso<0.9.0,>=0.8.4 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->ipython>=7.23.1->ipykernel) (0.8.4)\r\n",
      "Requirement already satisfied: anyio>=3.1.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (3.7.1)\r\n",
      "Requirement already satisfied: jupyter-events>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (0.11.0)\r\n",
      "Requirement already satisfied: jupyter-server-terminals in /usr/local/lib/python3.10/dist-packages (from jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (0.5.3)\r\n",
      "Requirement already satisfied: overrides in /usr/local/lib/python3.10/dist-packages (from jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (7.7.0)\r\n",
      "Requirement already satisfied: websocket-client in /usr/local/lib/python3.10/dist-packages (from jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.8.0)\r\n",
      "Requirement already satisfied: jupyter-server-fileid<1,>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-server-ydoc~=0.8.0->jupyterlab->jupyter) (0.9.3)\r\n",
      "Requirement already satisfied: ypy-websocket<0.9.0,>=0.8.2 in /usr/local/lib/python3.10/dist-packages (from jupyter-server-ydoc~=0.8.0->jupyterlab->jupyter) (0.8.4)\r\n",
      "Requirement already satisfied: y-py<0.7.0,>=0.6.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-ydoc~=0.2.4->jupyterlab->jupyter) (0.6.2)\r\n",
      "Requirement already satisfied: babel>=2.10 in /usr/local/lib/python3.10/dist-packages (from jupyterlab-server~=2.19->jupyterlab->jupyter) (2.16.0)\r\n",
      "Requirement already satisfied: json5>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from jupyterlab-server~=2.19->jupyterlab->jupyter) (0.10.0)\r\n",
      "Requirement already satisfied: jsonschema>=4.18.0 in /usr/local/lib/python3.10/dist-packages (from jupyterlab-server~=2.19->jupyterlab->jupyter) (4.23.0)\r\n",
      "Requirement already satisfied: notebook-shim>=0.2.3 in /usr/local/lib/python3.10/dist-packages (from nbclassic->jupyterlab->jupyter) (0.2.4)\r\n",
      "Requirement already satisfied: fastjsonschema>=2.15 in /usr/local/lib/python3.10/dist-packages (from nbformat->notebook->jupyter) (2.20.0)\r\n",
      "Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->ipython>=7.23.1->ipykernel) (0.7.0)\r\n",
      "Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython>=7.23.1->ipykernel) (0.2.13)\r\n",
      "Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.10/dist-packages (from argon2-cffi->notebook->jupyter) (21.2.0)\r\n",
      "Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->nbconvert->jupyter) (2.6)\r\n",
      "Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach->nbconvert->jupyter) (0.5.1)\r\n",
      "Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio>=3.1.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.3.1)\r\n",
      "Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anyio>=3.1.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.2.2)\r\n",
      "Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=4.18.0->jupyterlab-server~=2.19->jupyterlab->jupyter) (24.2.0)\r\n",
      "Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=4.18.0->jupyterlab-server~=2.19->jupyterlab->jupyter) (2023.12.1)\r\n",
      "Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=4.18.0->jupyterlab-server~=2.19->jupyterlab->jupyter) (0.35.1)\r\n",
      "Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema>=4.18.0->jupyterlab-server~=2.19->jupyterlab->jupyter) (0.20.0)\r\n",
      "Requirement already satisfied: python-json-logger>=2.0.4 in /usr/local/lib/python3.10/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (3.2.1)\r\n",
      "Requirement already satisfied: rfc3339-validator in /usr/local/lib/python3.10/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (0.1.4)\r\n",
      "Requirement already satisfied: rfc3986-validator>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (0.1.1)\r\n",
      "Requirement already satisfied: aiofiles<23,>=22.1.0 in /usr/local/lib/python3.10/dist-packages (from ypy-websocket<0.9.0,>=0.8.2->jupyter-server-ydoc~=0.8.0->jupyterlab->jupyter) (22.1.0)\r\n",
      "Requirement already satisfied: aiosqlite<1,>=0.17.0 in /usr/local/lib/python3.10/dist-packages (from ypy-websocket<0.9.0,>=0.8.2->jupyter-server-ydoc~=0.8.0->jupyterlab->jupyter) (0.20.0)\r\n",
      "Requirement already satisfied: cffi>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-bindings->argon2-cffi->notebook->jupyter) (1.17.1)\r\n",
      "Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.0.1->argon2-cffi-bindings->argon2-cffi->notebook->jupyter) (2.22)\r\n",
      "Requirement already satisfied: fqdn in /usr/local/lib/python3.10/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.5.1)\r\n",
      "Requirement already satisfied: isoduration in /usr/local/lib/python3.10/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (20.11.0)\r\n",
      "Requirement already satisfied: jsonpointer>1.13 in /usr/local/lib/python3.10/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (3.0.0)\r\n",
      "Requirement already satisfied: uri-template in /usr/local/lib/python3.10/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.3.0)\r\n",
      "Requirement already satisfied: webcolors>=24.6.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (24.8.0)\r\n",
      "Requirement already satisfied: arrow>=0.15.0 in /usr/local/lib/python3.10/dist-packages (from isoduration->jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (1.3.0)\r\n",
      "Requirement already satisfied: types-python-dateutil>=2.8.10 in /usr/local/lib/python3.10/dist-packages (from arrow>=0.15.0->isoduration->jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=1.16.0->jupyterlab->jupyter) (2.9.0.20241206)\r\n",
      "Downloading jupyter-1.1.1-py2.py3-none-any.whl (2.7 kB)\r\n",
      "Downloading ipykernel-6.29.5-py3-none-any.whl (117 kB)\r\n",
      "\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m117.2/117.2 kB\u001b[0m \u001b[31m2.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: ipykernel, jupyter\r\n",
      "  Attempting uninstall: ipykernel\r\n",
      "    Found existing installation: ipykernel 5.5.6\r\n",
      "    Uninstalling ipykernel-5.5.6:\r\n",
      "      Successfully uninstalled ipykernel-5.5.6\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "google-colab 1.0.0 requires ipykernel==5.5.6, but you have ipykernel 6.29.5 which is incompatible.\r\n",
      "google-colab 1.0.0 requires notebook==6.5.5, but you have notebook 6.5.4 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed ipykernel-6.29.5 jupyter-1.1.1\r\n"
     ]
    }
   ],
   "source": [
    "!pip install --upgrade wandb jupyter ipykernel\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "f5e44f59",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:40.934821Z",
     "iopub.status.busy": "2025-01-03T00:25:40.934422Z",
     "iopub.status.idle": "2025-01-03T00:25:41.058363Z",
     "shell.execute_reply": "2025-01-03T00:25:41.057109Z"
    },
    "papermill": {
     "duration": 0.132048,
     "end_time": "2025-01-03T00:25:41.060164",
     "exception": false,
     "start_time": "2025-01-03T00:25:40.928116",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Copying file: /kaggle/input/workingfiles/data_process.py to /kaggle/working/data_process.py\n",
      "Copying file: /kaggle/input/workingfiles/indicators.py to /kaggle/working/indicators.py\n",
      "Copying file: /kaggle/input/workingfiles/plots.py to /kaggle/working/plots.py\n",
      "Copying file: /kaggle/input/workingfiles/test.py to /kaggle/working/test.py\n",
      "Copying file: /kaggle/input/workingfiles/sweep_initializer.py to /kaggle/working/sweep_initializer.py\n",
      "Copying file: /kaggle/input/workingfiles/main.py to /kaggle/working/main.py\n",
      "Copying file: /kaggle/input/workingfiles/wandb_utilities.py to /kaggle/working/wandb_utilities.py\n",
      "Copying file: /kaggle/input/workingfiles/environment.py to /kaggle/working/environment.py\n",
      "Copying file: /kaggle/input/workingfiles/train6.py to /kaggle/working/train6.py\n",
      "Copying file: /kaggle/input/workingfiles/register_env.py to /kaggle/working/register_env.py\n",
      "Copying file: /kaggle/input/workingfiles/agent_runner.py to /kaggle/working/agent_runner.py\n",
      "Copying file: /kaggle/input/workingfiles/validate.py to /kaggle/working/validate.py\n",
      "Copying ppo_trading_model directory from /kaggle/input/models/pytorch/default/1/models to /kaggle/working/models\n",
      "ppo_trading_model directory successfully copied to /kaggle/working/models\n",
      "All files and ppo_trading_model directory copied successfully to /kaggle/working.\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import shutil\n",
    "\n",
    "# Define source directories and target directory\n",
    "rl_scripts_dir = \"/kaggle/input/workingfiles\"\n",
    "ppo_model_dir = \"/kaggle/input/models/pytorch/default/1/models\"\n",
    "target_dir = \"/kaggle/working\"\n",
    "\n",
    "# Ensure the target directory exists\n",
    "os.makedirs(target_dir, exist_ok=True)\n",
    "\n",
    "# Copy all files from the RL Scripts directory (excluding the models folder)\n",
    "for filename in os.listdir(rl_scripts_dir):\n",
    "    source_file = os.path.join(rl_scripts_dir, filename)\n",
    "    target_file = os.path.join(target_dir, filename)\n",
    "\n",
    "    if os.path.isfile(source_file):  # Copy regular files\n",
    "        print(f\"Copying file: {source_file} to {target_file}\")\n",
    "        shutil.copy(source_file, target_file)\n",
    "    elif os.path.isdir(source_file) and filename != \"models\":  # Skip the models directory\n",
    "        print(f\"Copying directory: {source_file} to {target_file}\")\n",
    "        shutil.copytree(source_file, target_file, dirs_exist_ok=True)\n",
    "\n",
    "# Copy the entire ppo_trading_model directory as a directory\n",
    "ppo_target_dir = os.path.join(target_dir, \"models\")\n",
    "os.makedirs(os.path.dirname(ppo_target_dir), exist_ok=True)\n",
    "\n",
    "if os.path.exists(ppo_model_dir):\n",
    "    print(f\"Copying ppo_trading_model directory from {ppo_model_dir} to {ppo_target_dir}\")\n",
    "    shutil.copytree(ppo_model_dir, ppo_target_dir, dirs_exist_ok=True)\n",
    "    print(f\"ppo_trading_model directory successfully copied to {ppo_target_dir}\")\n",
    "else:\n",
    "    print(f\"Source directory {ppo_model_dir} does not exist.\")\n",
    "\n",
    "print(\"All files and ppo_trading_model directory copied successfully to /kaggle/working.\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e3f2dd83",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:41.071855Z",
     "iopub.status.busy": "2025-01-03T00:25:41.071426Z",
     "iopub.status.idle": "2025-01-03T00:25:44.390149Z",
     "shell.execute_reply": "2025-01-03T00:25:44.389084Z"
    },
    "papermill": {
     "duration": 3.326473,
     "end_time": "2025-01-03T00:25:44.391798",
     "exception": false,
     "start_time": "2025-01-03T00:25:41.065325",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mgm6629\u001b[0m (\u001b[33mgm6629-rochester-institute-of-technology\u001b[0m). Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m If you're specifying your api key in code, ensure this code is not shared publicly.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Appending key for api.wandb.ai to your netrc file: /root/.netrc\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import wandb\n",
    "\n",
    "# Log in using your API key\n",
    "wandb.login(key=\"5e18e370a637f21653acc86589e609ec7f28067e\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "434d9096",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-01-03T00:25:44.403975Z",
     "iopub.status.busy": "2025-01-03T00:25:44.403587Z",
     "iopub.status.idle": "2025-01-03T03:22:15.758983Z",
     "shell.execute_reply": "2025-01-03T03:22:15.757024Z"
    },
    "papermill": {
     "duration": 10591.364894,
     "end_time": "2025-01-03T03:22:15.762232",
     "exception": false,
     "start_time": "2025-01-03T00:25:44.397338",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mgm6629\u001b[0m (\u001b[33mgm6629-rochester-institute-of-technology\u001b[0m). Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\r\n",
      "/usr/local/lib/python3.10/dist-packages/pydantic/main.py:1309: PydanticDeprecatedSince20: The `copy` method is deprecated; use `model_copy` instead. See the docstring of `BaseModel.copy` for details about how to handle `include` and `exclude`. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/\r\n",
      "  warnings.warn(\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.19.1\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/kaggle/working/wandb/run-20250103_002554-o0wqg97o\u001b[0m\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run \u001b[1m`wandb offline`\u001b[0m to turn off syncing.\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Syncing run \u001b[33menhanced_trading_bot_with_dynamic_hp\u001b[0m\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ‚≠êÔ∏è View project at \u001b[34m\u001b[4mhttps://wandb.ai/gm6629-rochester-institute-of-technology/trading_bot_training\u001b[0m\r\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: üöÄ View run at \u001b[34m\u001b[4mhttps://wandb.ai/gm6629-rochester-institute-of-technology/trading_bot_training/runs/o0wqg97o\u001b[0m\r\n",
      "/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/save_util.py:437: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\r\n",
      "  th_object = th.load(file_content, map_location=device)\r\n",
      "Logging to ./tensorboard_logs/PPO_0\r\n",
      "--------------------------------\r\n",
      "| time/              |         |\r\n",
      "|    fps             | 472     |\r\n",
      "|    iterations      | 1       |\r\n",
      "|    time_elapsed    | 4       |\r\n",
      "|    total_timesteps | 1003520 |\r\n",
      "--------------------------------\r\n",
      "-----------------------------------------\r\n",
      "| time/                   |             |\r\n",
      "|    fps                  | 407         |\r\n",
      "|    iterations           | 2           |\r\n",
      "|    time_elapsed         | 10          |\r\n",
      "|    total_timesteps      | 1005568     |\r\n",
      "| train/                  |             |\r\n",
      "|    approx_kl            | 1.49064e-06 |\r\n",
      "|    clip_fraction        | 0           |\r\n",
      "|    clip_range           | 0.2         |\r\n",
      "|    entropy_loss         | -0.016      |\r\n",
      "|    explained_variance   | 2.38e-07    |\r\n",
      "|    learning_rate        | 0.0001      |\r\n",
      "|    loss                 | 874         |\r\n",
      "|    n_updates            | 4900        |\r\n",
      "|    policy_gradient_loss | -5.9e-06    |\r\n",
      "|    value_loss           | 2.01e+03    |\r\n",
      "-----------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 391           |\r\n",
      "|    iterations           | 3             |\r\n",
      "|    time_elapsed         | 15            |\r\n",
      "|    total_timesteps      | 1007616       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 1.1874363e-08 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.016        |\r\n",
      "|    explained_variance   | 0             |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 961           |\r\n",
      "|    n_updates            | 4910          |\r\n",
      "|    policy_gradient_loss | 2.27e-06      |\r\n",
      "|    value_loss           | 2.1e+03       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 386           |\r\n",
      "|    iterations           | 4             |\r\n",
      "|    time_elapsed         | 21            |\r\n",
      "|    total_timesteps      | 1009664       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 1.7869752e-08 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.016        |\r\n",
      "|    explained_variance   | 1.13e-06      |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 499           |\r\n",
      "|    n_updates            | 4920          |\r\n",
      "|    policy_gradient_loss | -5.24e-07     |\r\n",
      "|    value_loss           | 2.06e+03      |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 381           |\r\n",
      "|    iterations           | 5             |\r\n",
      "|    time_elapsed         | 26            |\r\n",
      "|    total_timesteps      | 1011712       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 7.9280086e-05 |\r\n",
      "|    clip_fraction        | 0.000879      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0185       |\r\n",
      "|    explained_variance   | -0.0313       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 12            |\r\n",
      "|    n_updates            | 4930          |\r\n",
      "|    policy_gradient_loss | -0.000142     |\r\n",
      "|    value_loss           | 40.4          |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 379           |\r\n",
      "|    iterations           | 6             |\r\n",
      "|    time_elapsed         | 32            |\r\n",
      "|    total_timesteps      | 1013760       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 5.7110563e-05 |\r\n",
      "|    clip_fraction        | 0.000146      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0212       |\r\n",
      "|    explained_variance   | -0.000479     |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.848         |\r\n",
      "|    n_updates            | 4940          |\r\n",
      "|    policy_gradient_loss | -7e-05        |\r\n",
      "|    value_loss           | 99.8          |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 376           |\r\n",
      "|    iterations           | 7             |\r\n",
      "|    time_elapsed         | 38            |\r\n",
      "|    total_timesteps      | 1015808       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.2618915e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0232       |\r\n",
      "|    explained_variance   | -0.0205       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.216         |\r\n",
      "|    n_updates            | 4950          |\r\n",
      "|    policy_gradient_loss | -3.36e-05     |\r\n",
      "|    value_loss           | 56.8          |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 375          |\r\n",
      "|    iterations           | 8            |\r\n",
      "|    time_elapsed         | 43           |\r\n",
      "|    total_timesteps      | 1017856      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 8.492498e-07 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.024       |\r\n",
      "|    explained_variance   | -0.0817      |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.731        |\r\n",
      "|    n_updates            | 4960         |\r\n",
      "|    policy_gradient_loss | 6.98e-06     |\r\n",
      "|    value_loss           | 31           |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 373          |\r\n",
      "|    iterations           | 9            |\r\n",
      "|    time_elapsed         | 49           |\r\n",
      "|    total_timesteps      | 1019904      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 1.197512e-05 |\r\n",
      "|    clip_fraction        | 0.000293     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.022       |\r\n",
      "|    explained_variance   | -0.0601      |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 1.46         |\r\n",
      "|    n_updates            | 4970         |\r\n",
      "|    policy_gradient_loss | 1.1e-05      |\r\n",
      "|    value_loss           | 18.4         |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 372          |\r\n",
      "|    iterations           | 10           |\r\n",
      "|    time_elapsed         | 54           |\r\n",
      "|    total_timesteps      | 1021952      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 3.764959e-05 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0234      |\r\n",
      "|    explained_variance   | -0.0924      |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.886        |\r\n",
      "|    n_updates            | 4980         |\r\n",
      "|    policy_gradient_loss | -2.09e-05    |\r\n",
      "|    value_loss           | 13.6         |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 371           |\r\n",
      "|    iterations           | 11            |\r\n",
      "|    time_elapsed         | 60            |\r\n",
      "|    total_timesteps      | 1024000       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00013720753 |\r\n",
      "|    clip_fraction        | 0.000537      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0234       |\r\n",
      "|    explained_variance   | 0.00468       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0125        |\r\n",
      "|    n_updates            | 4990          |\r\n",
      "|    policy_gradient_loss | -0.000277     |\r\n",
      "|    value_loss           | 10.1          |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 371          |\r\n",
      "|    iterations           | 12           |\r\n",
      "|    time_elapsed         | 66           |\r\n",
      "|    total_timesteps      | 1026048      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 9.874371e-05 |\r\n",
      "|    clip_fraction        | 0.00327      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.025       |\r\n",
      "|    explained_variance   | 0.0346       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.0325       |\r\n",
      "|    n_updates            | 5000         |\r\n",
      "|    policy_gradient_loss | -0.000496    |\r\n",
      "|    value_loss           | 6.4          |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 371          |\r\n",
      "|    iterations           | 13           |\r\n",
      "|    time_elapsed         | 71           |\r\n",
      "|    total_timesteps      | 1028096      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 7.106381e-05 |\r\n",
      "|    clip_fraction        | 0.000928     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0259      |\r\n",
      "|    explained_variance   | 0.11         |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.0136       |\r\n",
      "|    n_updates            | 5010         |\r\n",
      "|    policy_gradient_loss | -5.3e-05     |\r\n",
      "|    value_loss           | 3.38         |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 370           |\r\n",
      "|    iterations           | 14            |\r\n",
      "|    time_elapsed         | 77            |\r\n",
      "|    total_timesteps      | 1030144       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 7.4436975e-05 |\r\n",
      "|    clip_fraction        | 0.00112       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.031        |\r\n",
      "|    explained_variance   | -0.0637       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0749        |\r\n",
      "|    n_updates            | 5020          |\r\n",
      "|    policy_gradient_loss | 1.12e-05      |\r\n",
      "|    value_loss           | 2.45          |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 369          |\r\n",
      "|    iterations           | 15           |\r\n",
      "|    time_elapsed         | 83           |\r\n",
      "|    total_timesteps      | 1032192      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 6.141432e-05 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0296      |\r\n",
      "|    explained_variance   | 0.439        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.085        |\r\n",
      "|    n_updates            | 5030         |\r\n",
      "|    policy_gradient_loss | -3.15e-05    |\r\n",
      "|    value_loss           | 1.16         |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 369           |\r\n",
      "|    iterations           | 16            |\r\n",
      "|    time_elapsed         | 88            |\r\n",
      "|    total_timesteps      | 1034240       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00058142527 |\r\n",
      "|    clip_fraction        | 0.00269       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0224       |\r\n",
      "|    explained_variance   | -0.0914       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0569        |\r\n",
      "|    n_updates            | 5040          |\r\n",
      "|    policy_gradient_loss | -0.000336     |\r\n",
      "|    value_loss           | 0.921         |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 368           |\r\n",
      "|    iterations           | 17            |\r\n",
      "|    time_elapsed         | 94            |\r\n",
      "|    total_timesteps      | 1036288       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.6424474e-05 |\r\n",
      "|    clip_fraction        | 0.000293      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.018        |\r\n",
      "|    explained_variance   | 0.436         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0184        |\r\n",
      "|    n_updates            | 5050          |\r\n",
      "|    policy_gradient_loss | -0.000226     |\r\n",
      "|    value_loss           | 0.473         |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 368           |\r\n",
      "|    iterations           | 18            |\r\n",
      "|    time_elapsed         | 100           |\r\n",
      "|    total_timesteps      | 1038336       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00018814622 |\r\n",
      "|    clip_fraction        | 0.00244       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0202       |\r\n",
      "|    explained_variance   | 0.542         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0458        |\r\n",
      "|    n_updates            | 5060          |\r\n",
      "|    policy_gradient_loss | -2.16e-05     |\r\n",
      "|    value_loss           | 0.347         |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 367          |\r\n",
      "|    iterations           | 19           |\r\n",
      "|    time_elapsed         | 105          |\r\n",
      "|    total_timesteps      | 1040384      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 6.230333e-05 |\r\n",
      "|    clip_fraction        | 0.000439     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0212      |\r\n",
      "|    explained_variance   | 0.799        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.027        |\r\n",
      "|    n_updates            | 5070         |\r\n",
      "|    policy_gradient_loss | -0.000399    |\r\n",
      "|    value_loss           | 0.304        |\r\n",
      "------------------------------------------\r\n",
      "--------------------------------------------\r\n",
      "| time/                   |                |\r\n",
      "|    fps                  | 367            |\r\n",
      "|    iterations           | 20             |\r\n",
      "|    time_elapsed         | 111            |\r\n",
      "|    total_timesteps      | 1042432        |\r\n",
      "| train/                  |                |\r\n",
      "|    approx_kl            | 0.000108239794 |\r\n",
      "|    clip_fraction        | 0.000781       |\r\n",
      "|    clip_range           | 0.2            |\r\n",
      "|    entropy_loss         | -0.0251        |\r\n",
      "|    explained_variance   | 0.0953         |\r\n",
      "|    learning_rate        | 0.0001         |\r\n",
      "|    loss                 | 0.0023         |\r\n",
      "|    n_updates            | 5080           |\r\n",
      "|    policy_gradient_loss | -6.62e-05      |\r\n",
      "|    value_loss           | 0.14           |\r\n",
      "--------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 367           |\r\n",
      "|    iterations           | 21            |\r\n",
      "|    time_elapsed         | 116           |\r\n",
      "|    total_timesteps      | 1044480       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00026689173 |\r\n",
      "|    clip_fraction        | 0.0022        |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0245       |\r\n",
      "|    explained_variance   | 0.609         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00495       |\r\n",
      "|    n_updates            | 5090          |\r\n",
      "|    policy_gradient_loss | -0.00019      |\r\n",
      "|    value_loss           | 0.0891        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 367           |\r\n",
      "|    iterations           | 22            |\r\n",
      "|    time_elapsed         | 122           |\r\n",
      "|    total_timesteps      | 1046528       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 3.2888638e-05 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0207       |\r\n",
      "|    explained_variance   | 0.539         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00501       |\r\n",
      "|    n_updates            | 5100          |\r\n",
      "|    policy_gradient_loss | 3.78e-05      |\r\n",
      "|    value_loss           | 0.0667        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 367           |\r\n",
      "|    iterations           | 23            |\r\n",
      "|    time_elapsed         | 128           |\r\n",
      "|    total_timesteps      | 1048576       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 1.3068959e-05 |\r\n",
      "|    clip_fraction        | 0.000488      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0166       |\r\n",
      "|    explained_variance   | -0.389        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00438       |\r\n",
      "|    n_updates            | 5110          |\r\n",
      "|    policy_gradient_loss | -9.9e-05      |\r\n",
      "|    value_loss           | 0.0422        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 367           |\r\n",
      "|    iterations           | 24            |\r\n",
      "|    time_elapsed         | 133           |\r\n",
      "|    total_timesteps      | 1050624       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 3.5728735e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0175       |\r\n",
      "|    explained_variance   | 0.86          |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0279        |\r\n",
      "|    n_updates            | 5120          |\r\n",
      "|    policy_gradient_loss | -9.82e-05     |\r\n",
      "|    value_loss           | 0.0588        |\r\n",
      "-------------------------------------------\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning: \u001b[33mWARN: env.current_step to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.current_step` for environment variables or `env.get_attr('current_step')` that will search the reminding wrappers.\u001b[0m\r\n",
      "  logger.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning: \u001b[33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_attr('data')` that will search the reminding wrappers.\u001b[0m\r\n",
      "  logger.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning: \u001b[33mWARN: env.balance to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.balance` for environment variables or `env.get_attr('balance')` that will search the reminding wrappers.\u001b[0m\r\n",
      "  logger.warn(\r\n",
      "Running visualizations...\r\n",
      "            timestamp  close  EMA_50  EMA_200\r\n",
      "0 2012-01-01 10:01:00   4.58    4.58     4.58\r\n",
      "1 2012-01-01 10:02:00   4.58    4.58     4.58\r\n",
      "2 2012-01-01 10:03:00   4.58    4.58     4.58\r\n",
      "3 2012-01-01 10:04:00   4.58    4.58     4.58\r\n",
      "4 2012-01-01 10:05:00   4.58    4.58     4.58\r\n",
      "/usr/local/lib/python3.10/dist-packages/jupyter_client/connect.py:22: DeprecationWarning:\r\n",
      "\r\n",
      "Jupyter is migrating its paths to use standard platformdirs\r\n",
      "given by the platformdirs library.  To remove this warning and\r\n",
      "see the appropriate new directories, set the environment variable\r\n",
      "`JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.\r\n",
      "The use of platformdirs will be the default in `jupyter_core` v6\r\n",
      "\r\n",
      "/usr/lib/python3.10/importlib/__init__.py:126: DeprecationWarning:\r\n",
      "\r\n",
      "`ipykernel.pylab.backend_inline` is deprecated, directly use `matplotlib_inline.backend_inline`\r\n",
      "\r\n",
      "Saved Matplotlib plot to: /kaggle/working/price_chart_20250103_010049.png\r\n",
      "Figure(1400x800)\r\n",
      "/kaggle/working/plots.py:99: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "/kaggle/working/plots.py:104: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "Saved RSI plot to: /kaggle/working/price_chart_20250103_010049_RSI.png\r\n",
      "Figure(1400x800)\r\n",
      "Figure(1400x800)\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 19            |\r\n",
      "|    iterations           | 25            |\r\n",
      "|    time_elapsed         | 2601          |\r\n",
      "|    total_timesteps      | 1052672       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.5670917e-05 |\r\n",
      "|    clip_fraction        | 4.88e-05      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0199       |\r\n",
      "|    explained_variance   | 0.771         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00624       |\r\n",
      "|    n_updates            | 5130          |\r\n",
      "|    policy_gradient_loss | -5.69e-05     |\r\n",
      "|    value_loss           | 0.0225        |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 20           |\r\n",
      "|    iterations           | 26           |\r\n",
      "|    time_elapsed         | 2607         |\r\n",
      "|    total_timesteps      | 1054720      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 6.653872e-05 |\r\n",
      "|    clip_fraction        | 0.00103      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.024       |\r\n",
      "|    explained_variance   | -0.185       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00575      |\r\n",
      "|    n_updates            | 5140         |\r\n",
      "|    policy_gradient_loss | -0.000459    |\r\n",
      "|    value_loss           | 0.0166       |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 21            |\r\n",
      "|    iterations           | 27            |\r\n",
      "|    time_elapsed         | 2613          |\r\n",
      "|    total_timesteps      | 1056768       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00012328124 |\r\n",
      "|    clip_fraction        | 0.00117       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0218       |\r\n",
      "|    explained_variance   | 0.834         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00558       |\r\n",
      "|    n_updates            | 5150          |\r\n",
      "|    policy_gradient_loss | -0.000277     |\r\n",
      "|    value_loss           | 0.0112        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 21            |\r\n",
      "|    iterations           | 28            |\r\n",
      "|    time_elapsed         | 2618          |\r\n",
      "|    total_timesteps      | 1058816       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 5.3172436e-05 |\r\n",
      "|    clip_fraction        | 9.77e-05      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0186       |\r\n",
      "|    explained_variance   | 0.757         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0067        |\r\n",
      "|    n_updates            | 5160          |\r\n",
      "|    policy_gradient_loss | -9.86e-06     |\r\n",
      "|    value_loss           | 0.0189        |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 22           |\r\n",
      "|    iterations           | 29           |\r\n",
      "|    time_elapsed         | 2624         |\r\n",
      "|    total_timesteps      | 1060864      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 8.779811e-06 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0172      |\r\n",
      "|    explained_variance   | 0.674        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00151      |\r\n",
      "|    n_updates            | 5170         |\r\n",
      "|    policy_gradient_loss | 4.62e-06     |\r\n",
      "|    value_loss           | 0.0208       |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 23            |\r\n",
      "|    iterations           | 30            |\r\n",
      "|    time_elapsed         | 2630          |\r\n",
      "|    total_timesteps      | 1062912       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 5.9292943e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0165       |\r\n",
      "|    explained_variance   | 0.493         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00153       |\r\n",
      "|    n_updates            | 5180          |\r\n",
      "|    policy_gradient_loss | -2.41e-05     |\r\n",
      "|    value_loss           | 0.00848       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 24            |\r\n",
      "|    iterations           | 31            |\r\n",
      "|    time_elapsed         | 2636          |\r\n",
      "|    total_timesteps      | 1064960       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 1.5709142e-05 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0183       |\r\n",
      "|    explained_variance   | 0.596         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0268        |\r\n",
      "|    n_updates            | 5190          |\r\n",
      "|    policy_gradient_loss | -7.49e-05     |\r\n",
      "|    value_loss           | 0.0428        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 24            |\r\n",
      "|    iterations           | 32            |\r\n",
      "|    time_elapsed         | 2642          |\r\n",
      "|    total_timesteps      | 1067008       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00021019089 |\r\n",
      "|    clip_fraction        | 0.00156       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0154       |\r\n",
      "|    explained_variance   | 0.811         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000972      |\r\n",
      "|    n_updates            | 5200          |\r\n",
      "|    policy_gradient_loss | -0.000452     |\r\n",
      "|    value_loss           | 0.0113        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 25            |\r\n",
      "|    iterations           | 33            |\r\n",
      "|    time_elapsed         | 2647          |\r\n",
      "|    total_timesteps      | 1069056       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00014078314 |\r\n",
      "|    clip_fraction        | 0.00132       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0153       |\r\n",
      "|    explained_variance   | 0.749         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.0123       |\r\n",
      "|    n_updates            | 5210          |\r\n",
      "|    policy_gradient_loss | -0.00082      |\r\n",
      "|    value_loss           | 0.00794       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 26            |\r\n",
      "|    iterations           | 34            |\r\n",
      "|    time_elapsed         | 2653          |\r\n",
      "|    total_timesteps      | 1071104       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.5993213e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0172       |\r\n",
      "|    explained_variance   | -0.42         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000419      |\r\n",
      "|    n_updates            | 5220          |\r\n",
      "|    policy_gradient_loss | 6.32e-06      |\r\n",
      "|    value_loss           | 0.00434       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 26            |\r\n",
      "|    iterations           | 35            |\r\n",
      "|    time_elapsed         | 2659          |\r\n",
      "|    total_timesteps      | 1073152       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00019609576 |\r\n",
      "|    clip_fraction        | 0.00122       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.021        |\r\n",
      "|    explained_variance   | 0.838         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00237       |\r\n",
      "|    n_updates            | 5230          |\r\n",
      "|    policy_gradient_loss | -0.000989     |\r\n",
      "|    value_loss           | 0.00863       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 27            |\r\n",
      "|    iterations           | 36            |\r\n",
      "|    time_elapsed         | 2664          |\r\n",
      "|    total_timesteps      | 1075200       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 7.9021615e-05 |\r\n",
      "|    clip_fraction        | 0.000781      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0269       |\r\n",
      "|    explained_variance   | -0.0205       |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00433       |\r\n",
      "|    n_updates            | 5240          |\r\n",
      "|    policy_gradient_loss | -0.00025      |\r\n",
      "|    value_loss           | 0.00434       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 28           |\r\n",
      "|    iterations           | 37           |\r\n",
      "|    time_elapsed         | 2670         |\r\n",
      "|    total_timesteps      | 1077248      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0001077512 |\r\n",
      "|    clip_fraction        | 0.000928     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0311      |\r\n",
      "|    explained_variance   | 0.54         |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00361      |\r\n",
      "|    n_updates            | 5250         |\r\n",
      "|    policy_gradient_loss | -0.000115    |\r\n",
      "|    value_loss           | 0.00378      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 29            |\r\n",
      "|    iterations           | 38            |\r\n",
      "|    time_elapsed         | 2676          |\r\n",
      "|    total_timesteps      | 1079296       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.5473419e-05 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0355       |\r\n",
      "|    explained_variance   | -0.041        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00942       |\r\n",
      "|    n_updates            | 5260          |\r\n",
      "|    policy_gradient_loss | -4.44e-05     |\r\n",
      "|    value_loss           | 0.00671       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 29            |\r\n",
      "|    iterations           | 39            |\r\n",
      "|    time_elapsed         | 2681          |\r\n",
      "|    total_timesteps      | 1081344       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00031227054 |\r\n",
      "|    clip_fraction        | 0.00127       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0403       |\r\n",
      "|    explained_variance   | 0.329         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00403       |\r\n",
      "|    n_updates            | 5270          |\r\n",
      "|    policy_gradient_loss | 0.000108      |\r\n",
      "|    value_loss           | 0.00624       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 30           |\r\n",
      "|    iterations           | 40           |\r\n",
      "|    time_elapsed         | 2687         |\r\n",
      "|    total_timesteps      | 1083392      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 9.293406e-06 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0467      |\r\n",
      "|    explained_variance   | -0.407       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.000239     |\r\n",
      "|    n_updates            | 5280         |\r\n",
      "|    policy_gradient_loss | 0.000108     |\r\n",
      "|    value_loss           | 0.00366      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 31            |\r\n",
      "|    iterations           | 41            |\r\n",
      "|    time_elapsed         | 2693          |\r\n",
      "|    total_timesteps      | 1085440       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00017654168 |\r\n",
      "|    clip_fraction        | 0.00161       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0532       |\r\n",
      "|    explained_variance   | -0.252        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 5.97e-05      |\r\n",
      "|    n_updates            | 5290          |\r\n",
      "|    policy_gradient_loss | -0.00013      |\r\n",
      "|    value_loss           | 0.00139       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 31            |\r\n",
      "|    iterations           | 42            |\r\n",
      "|    time_elapsed         | 2698          |\r\n",
      "|    total_timesteps      | 1087488       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00024769903 |\r\n",
      "|    clip_fraction        | 0.00415       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0609       |\r\n",
      "|    explained_variance   | -1.16         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000199      |\r\n",
      "|    n_updates            | 5300          |\r\n",
      "|    policy_gradient_loss | -0.000249     |\r\n",
      "|    value_loss           | 0.00139       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 32            |\r\n",
      "|    iterations           | 43            |\r\n",
      "|    time_elapsed         | 2704          |\r\n",
      "|    total_timesteps      | 1089536       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00023648076 |\r\n",
      "|    clip_fraction        | 0.00161       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0688       |\r\n",
      "|    explained_variance   | 0.0747        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00333      |\r\n",
      "|    n_updates            | 5310          |\r\n",
      "|    policy_gradient_loss | -4.45e-05     |\r\n",
      "|    value_loss           | 0.00129       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 33            |\r\n",
      "|    iterations           | 44            |\r\n",
      "|    time_elapsed         | 2710          |\r\n",
      "|    total_timesteps      | 1091584       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00016882399 |\r\n",
      "|    clip_fraction        | 0.00117       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0813       |\r\n",
      "|    explained_variance   | -0.556        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.000157     |\r\n",
      "|    n_updates            | 5320          |\r\n",
      "|    policy_gradient_loss | -1.98e-05     |\r\n",
      "|    value_loss           | 0.00136       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 33           |\r\n",
      "|    iterations           | 45           |\r\n",
      "|    time_elapsed         | 2715         |\r\n",
      "|    total_timesteps      | 1093632      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0002482558 |\r\n",
      "|    clip_fraction        | 0.00493      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0955      |\r\n",
      "|    explained_variance   | -0.556       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00518     |\r\n",
      "|    n_updates            | 5330         |\r\n",
      "|    policy_gradient_loss | -0.000436    |\r\n",
      "|    value_loss           | 0.00149      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 34            |\r\n",
      "|    iterations           | 46            |\r\n",
      "|    time_elapsed         | 2721          |\r\n",
      "|    total_timesteps      | 1095680       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00014697018 |\r\n",
      "|    clip_fraction        | 0.00151       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.109        |\r\n",
      "|    explained_variance   | 0.33          |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00661      |\r\n",
      "|    n_updates            | 5340          |\r\n",
      "|    policy_gradient_loss | 5.03e-06      |\r\n",
      "|    value_loss           | 0.00142       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 35            |\r\n",
      "|    iterations           | 47            |\r\n",
      "|    time_elapsed         | 2727          |\r\n",
      "|    total_timesteps      | 1097728       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00025776352 |\r\n",
      "|    clip_fraction        | 0.00674       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.124        |\r\n",
      "|    explained_variance   | -4.75         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00682      |\r\n",
      "|    n_updates            | 5350          |\r\n",
      "|    policy_gradient_loss | -0.000474     |\r\n",
      "|    value_loss           | 0.00127       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 35           |\r\n",
      "|    iterations           | 48           |\r\n",
      "|    time_elapsed         | 2732         |\r\n",
      "|    total_timesteps      | 1099776      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0002741836 |\r\n",
      "|    clip_fraction        | 0.0021       |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.137       |\r\n",
      "|    explained_variance   | -0.121       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00216      |\r\n",
      "|    n_updates            | 5360         |\r\n",
      "|    policy_gradient_loss | 8.13e-05     |\r\n",
      "|    value_loss           | 0.00121      |\r\n",
      "------------------------------------------\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.current_step to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.current_step` for environment variables or `env.get_attr('current_step')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_attr('data')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.balance to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.balance` for environment variables or `env.get_attr('balance')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "Running visualizations...\r\n",
      "            timestamp  close  EMA_50  EMA_200\r\n",
      "0 2012-01-01 10:01:00   4.58    4.58     4.58\r\n",
      "1 2012-01-01 10:02:00   4.58    4.58     4.58\r\n",
      "2 2012-01-01 10:03:00   4.58    4.58     4.58\r\n",
      "3 2012-01-01 10:04:00   4.58    4.58     4.58\r\n",
      "4 2012-01-01 10:05:00   4.58    4.58     4.58\r\n",
      "Saved Matplotlib plot to: /kaggle/working/price_chart_20250103_014436.png\r\n",
      "Figure(1400x800)\r\n",
      "/kaggle/working/plots.py:99: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "/kaggle/working/plots.py:104: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "Saved RSI plot to: /kaggle/working/price_chart_20250103_014436_RSI.png\r\n",
      "Figure(1400x800)\r\n",
      "Figure(1400x800)\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 19            |\r\n",
      "|    iterations           | 49            |\r\n",
      "|    time_elapsed         | 5232          |\r\n",
      "|    total_timesteps      | 1101824       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00024007581 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.15         |\r\n",
      "|    explained_variance   | -2.16         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000962      |\r\n",
      "|    n_updates            | 5370          |\r\n",
      "|    policy_gradient_loss | 0.000106      |\r\n",
      "|    value_loss           | 0.00119       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 19           |\r\n",
      "|    iterations           | 50           |\r\n",
      "|    time_elapsed         | 5238         |\r\n",
      "|    total_timesteps      | 1103872      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 5.351228e-05 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.154       |\r\n",
      "|    explained_variance   | -1.95        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000343    |\r\n",
      "|    n_updates            | 5380         |\r\n",
      "|    policy_gradient_loss | 6.77e-05     |\r\n",
      "|    value_loss           | 0.00141      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 19           |\r\n",
      "|    iterations           | 51           |\r\n",
      "|    time_elapsed         | 5244         |\r\n",
      "|    total_timesteps      | 1105920      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0006426553 |\r\n",
      "|    clip_fraction        | 0.0157       |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.169       |\r\n",
      "|    explained_variance   | -1.64        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.0049      |\r\n",
      "|    n_updates            | 5390         |\r\n",
      "|    policy_gradient_loss | -0.00117     |\r\n",
      "|    value_loss           | 0.00132      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 20            |\r\n",
      "|    iterations           | 52            |\r\n",
      "|    time_elapsed         | 5250          |\r\n",
      "|    total_timesteps      | 1107968       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00051427406 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.186        |\r\n",
      "|    explained_variance   | 0.342         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.000309     |\r\n",
      "|    n_updates            | 5400          |\r\n",
      "|    policy_gradient_loss | 0.000142      |\r\n",
      "|    value_loss           | 0.00125       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 20            |\r\n",
      "|    iterations           | 53            |\r\n",
      "|    time_elapsed         | 5256          |\r\n",
      "|    total_timesteps      | 1110016       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00054950814 |\r\n",
      "|    clip_fraction        | 0.00464       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.173        |\r\n",
      "|    explained_variance   | 0.883         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00415       |\r\n",
      "|    n_updates            | 5410          |\r\n",
      "|    policy_gradient_loss | -0.000398     |\r\n",
      "|    value_loss           | 0.00247       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 21           |\r\n",
      "|    iterations           | 54           |\r\n",
      "|    time_elapsed         | 5261         |\r\n",
      "|    total_timesteps      | 1112064      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 9.762333e-05 |\r\n",
      "|    clip_fraction        | 0.00215      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.172       |\r\n",
      "|    explained_variance   | 0.869        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000398    |\r\n",
      "|    n_updates            | 5420         |\r\n",
      "|    policy_gradient_loss | 6.73e-05     |\r\n",
      "|    value_loss           | 0.00251      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 21           |\r\n",
      "|    iterations           | 55           |\r\n",
      "|    time_elapsed         | 5267         |\r\n",
      "|    total_timesteps      | 1114112      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 9.458256e-05 |\r\n",
      "|    clip_fraction        | 0.00298      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.167       |\r\n",
      "|    explained_variance   | -0.487       |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00106     |\r\n",
      "|    n_updates            | 5430         |\r\n",
      "|    policy_gradient_loss | 0.000204     |\r\n",
      "|    value_loss           | 0.00421      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 21            |\r\n",
      "|    iterations           | 56            |\r\n",
      "|    time_elapsed         | 5273          |\r\n",
      "|    total_timesteps      | 1116160       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 1.2242235e-05 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.182        |\r\n",
      "|    explained_variance   | 0.888         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00113      |\r\n",
      "|    n_updates            | 5440          |\r\n",
      "|    policy_gradient_loss | 1.75e-05      |\r\n",
      "|    value_loss           | 0.00351       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 22           |\r\n",
      "|    iterations           | 57           |\r\n",
      "|    time_elapsed         | 5279         |\r\n",
      "|    total_timesteps      | 1118208      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0010765046 |\r\n",
      "|    clip_fraction        | 0.00332      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.161       |\r\n",
      "|    explained_variance   | 0.305        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 1.26e-05     |\r\n",
      "|    n_updates            | 5450         |\r\n",
      "|    policy_gradient_loss | -0.000895    |\r\n",
      "|    value_loss           | 0.00319      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 22           |\r\n",
      "|    iterations           | 58           |\r\n",
      "|    time_elapsed         | 5285         |\r\n",
      "|    total_timesteps      | 1120256      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 9.329565e-05 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.156       |\r\n",
      "|    explained_variance   | 0.474        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000142    |\r\n",
      "|    n_updates            | 5460         |\r\n",
      "|    policy_gradient_loss | 5.19e-05     |\r\n",
      "|    value_loss           | 0.00283      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 22            |\r\n",
      "|    iterations           | 59            |\r\n",
      "|    time_elapsed         | 5291          |\r\n",
      "|    total_timesteps      | 1122304       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00034481633 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.148        |\r\n",
      "|    explained_variance   | 0.117         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.0072       |\r\n",
      "|    n_updates            | 5470          |\r\n",
      "|    policy_gradient_loss | -8.53e-06     |\r\n",
      "|    value_loss           | 0.0015        |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 60           |\r\n",
      "|    time_elapsed         | 5297         |\r\n",
      "|    total_timesteps      | 1124352      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0003968622 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.14        |\r\n",
      "|    explained_variance   | 0.841        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.000449     |\r\n",
      "|    n_updates            | 5480         |\r\n",
      "|    policy_gradient_loss | -7.22e-06    |\r\n",
      "|    value_loss           | 0.00499      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 61           |\r\n",
      "|    time_elapsed         | 5303         |\r\n",
      "|    total_timesteps      | 1126400      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0005161665 |\r\n",
      "|    clip_fraction        | 0.0021       |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.138       |\r\n",
      "|    explained_variance   | 0.832        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.0072      |\r\n",
      "|    n_updates            | 5490         |\r\n",
      "|    policy_gradient_loss | -0.000262    |\r\n",
      "|    value_loss           | 0.00355      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 62           |\r\n",
      "|    time_elapsed         | 5309         |\r\n",
      "|    total_timesteps      | 1128448      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0004843494 |\r\n",
      "|    clip_fraction        | 0.0118       |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.167       |\r\n",
      "|    explained_variance   | 0.715        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00207     |\r\n",
      "|    n_updates            | 5500         |\r\n",
      "|    policy_gradient_loss | -0.00103     |\r\n",
      "|    value_loss           | 0.00201      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 24           |\r\n",
      "|    iterations           | 63           |\r\n",
      "|    time_elapsed         | 5315         |\r\n",
      "|    total_timesteps      | 1130496      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0008747437 |\r\n",
      "|    clip_fraction        | 0.00127      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.154       |\r\n",
      "|    explained_variance   | 0.899        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000913    |\r\n",
      "|    n_updates            | 5510         |\r\n",
      "|    policy_gradient_loss | -0.000425    |\r\n",
      "|    value_loss           | 0.00305      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 24            |\r\n",
      "|    iterations           | 64            |\r\n",
      "|    time_elapsed         | 5321          |\r\n",
      "|    total_timesteps      | 1132544       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00042593048 |\r\n",
      "|    clip_fraction        | 0.00859       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.162        |\r\n",
      "|    explained_variance   | 0.794         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00198       |\r\n",
      "|    n_updates            | 5520          |\r\n",
      "|    policy_gradient_loss | -0.000442     |\r\n",
      "|    value_loss           | 0.00348       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 24           |\r\n",
      "|    iterations           | 65           |\r\n",
      "|    time_elapsed         | 5327         |\r\n",
      "|    total_timesteps      | 1134592      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0009104704 |\r\n",
      "|    clip_fraction        | 0.00112      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.154       |\r\n",
      "|    explained_variance   | 0.00404      |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00563     |\r\n",
      "|    n_updates            | 5530         |\r\n",
      "|    policy_gradient_loss | -0.000414    |\r\n",
      "|    value_loss           | 0.00264      |\r\n",
      "------------------------------------------\r\n",
      "-----------------------------------------\r\n",
      "| time/                   |             |\r\n",
      "|    fps                  | 25          |\r\n",
      "|    iterations           | 66          |\r\n",
      "|    time_elapsed         | 5332        |\r\n",
      "|    total_timesteps      | 1136640     |\r\n",
      "| train/                  |             |\r\n",
      "|    approx_kl            | 0.000568317 |\r\n",
      "|    clip_fraction        | 0.00146     |\r\n",
      "|    clip_range           | 0.2         |\r\n",
      "|    entropy_loss         | -0.127      |\r\n",
      "|    explained_variance   | -2.33       |\r\n",
      "|    learning_rate        | 0.0001      |\r\n",
      "|    loss                 | 0.000476    |\r\n",
      "|    n_updates            | 5540        |\r\n",
      "|    policy_gradient_loss | -0.000472   |\r\n",
      "|    value_loss           | 0.00277     |\r\n",
      "-----------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 25            |\r\n",
      "|    iterations           | 67            |\r\n",
      "|    time_elapsed         | 5338          |\r\n",
      "|    total_timesteps      | 1138688       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00036070647 |\r\n",
      "|    clip_fraction        | 0.00347       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.128        |\r\n",
      "|    explained_variance   | 0.12          |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00388      |\r\n",
      "|    n_updates            | 5550          |\r\n",
      "|    policy_gradient_loss | -0.000153     |\r\n",
      "|    value_loss           | 0.0043        |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 26            |\r\n",
      "|    iterations           | 68            |\r\n",
      "|    time_elapsed         | 5344          |\r\n",
      "|    total_timesteps      | 1140736       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00060162647 |\r\n",
      "|    clip_fraction        | 0.00918       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.148        |\r\n",
      "|    explained_variance   | 0.783         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00309      |\r\n",
      "|    n_updates            | 5560          |\r\n",
      "|    policy_gradient_loss | -0.000561     |\r\n",
      "|    value_loss           | 0.00325       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 26            |\r\n",
      "|    iterations           | 69            |\r\n",
      "|    time_elapsed         | 5350          |\r\n",
      "|    total_timesteps      | 1142784       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00013783647 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.158        |\r\n",
      "|    explained_variance   | 0.915         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000312      |\r\n",
      "|    n_updates            | 5570          |\r\n",
      "|    policy_gradient_loss | 1.96e-05      |\r\n",
      "|    value_loss           | 0.00692       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 26            |\r\n",
      "|    iterations           | 70            |\r\n",
      "|    time_elapsed         | 5356          |\r\n",
      "|    total_timesteps      | 1144832       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 3.2189128e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.165        |\r\n",
      "|    explained_variance   | 0.866         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00257       |\r\n",
      "|    n_updates            | 5580          |\r\n",
      "|    policy_gradient_loss | 2.97e-05      |\r\n",
      "|    value_loss           | 0.0063        |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 27           |\r\n",
      "|    iterations           | 71           |\r\n",
      "|    time_elapsed         | 5362         |\r\n",
      "|    total_timesteps      | 1146880      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0006572403 |\r\n",
      "|    clip_fraction        | 0.00898      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.183       |\r\n",
      "|    explained_variance   | 0.816        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00465      |\r\n",
      "|    n_updates            | 5590         |\r\n",
      "|    policy_gradient_loss | -0.000797    |\r\n",
      "|    value_loss           | 0.00625      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 27            |\r\n",
      "|    iterations           | 72            |\r\n",
      "|    time_elapsed         | 5368          |\r\n",
      "|    total_timesteps      | 1148928       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 2.4687324e-06 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.188        |\r\n",
      "|    explained_variance   | 0.318         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0016        |\r\n",
      "|    n_updates            | 5600          |\r\n",
      "|    policy_gradient_loss | 2.49e-05      |\r\n",
      "|    value_loss           | 0.00587       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 27           |\r\n",
      "|    iterations           | 73           |\r\n",
      "|    time_elapsed         | 5374         |\r\n",
      "|    total_timesteps      | 1150976      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0012453825 |\r\n",
      "|    clip_fraction        | 0.00693      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.169       |\r\n",
      "|    explained_variance   | 0.347        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00017      |\r\n",
      "|    n_updates            | 5610         |\r\n",
      "|    policy_gradient_loss | -0.00102     |\r\n",
      "|    value_loss           | 0.00584      |\r\n",
      "------------------------------------------\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.current_step to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.current_step` for environment variables or `env.get_attr('current_step')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_attr('data')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.balance to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.balance` for environment variables or `env.get_attr('balance')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "Running visualizations...\r\n",
      "            timestamp  close  EMA_50  EMA_200\r\n",
      "0 2012-01-01 10:01:00   4.58    4.58     4.58\r\n",
      "1 2012-01-01 10:02:00   4.58    4.58     4.58\r\n",
      "2 2012-01-01 10:03:00   4.58    4.58     4.58\r\n",
      "3 2012-01-01 10:04:00   4.58    4.58     4.58\r\n",
      "4 2012-01-01 10:05:00   4.58    4.58     4.58\r\n",
      "Saved Matplotlib plot to: /kaggle/working/price_chart_20250103_022909.png\r\n",
      "Figure(1400x800)\r\n",
      "/kaggle/working/plots.py:99: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "/kaggle/working/plots.py:104: UserWarning:\r\n",
      "\r\n",
      "Creating legend with loc=\"best\" can be slow with large amounts of data.\r\n",
      "\r\n",
      "Saved RSI plot to: /kaggle/working/price_chart_20250103_022909_RSI.png\r\n",
      "Figure(1400x800)\r\n",
      "Figure(1400x800)\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 19            |\r\n",
      "|    iterations           | 74            |\r\n",
      "|    time_elapsed         | 7907          |\r\n",
      "|    total_timesteps      | 1153024       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00017652352 |\r\n",
      "|    clip_fraction        | 0.000391      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.16         |\r\n",
      "|    explained_variance   | 0.416         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.00104       |\r\n",
      "|    n_updates            | 5620          |\r\n",
      "|    policy_gradient_loss | -0.000106     |\r\n",
      "|    value_loss           | 0.00601       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 19            |\r\n",
      "|    iterations           | 75            |\r\n",
      "|    time_elapsed         | 7913          |\r\n",
      "|    total_timesteps      | 1155072       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 7.0001435e-05 |\r\n",
      "|    clip_fraction        | 0.0042        |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.16         |\r\n",
      "|    explained_variance   | -0.179        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.0019       |\r\n",
      "|    n_updates            | 5630          |\r\n",
      "|    policy_gradient_loss | -0.000602     |\r\n",
      "|    value_loss           | 0.00406       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 19            |\r\n",
      "|    iterations           | 76            |\r\n",
      "|    time_elapsed         | 7919          |\r\n",
      "|    total_timesteps      | 1157120       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00018976725 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.142        |\r\n",
      "|    explained_variance   | 0.665         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00176      |\r\n",
      "|    n_updates            | 5640          |\r\n",
      "|    policy_gradient_loss | 6.41e-05      |\r\n",
      "|    value_loss           | 0.00599       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 19           |\r\n",
      "|    iterations           | 77           |\r\n",
      "|    time_elapsed         | 7925         |\r\n",
      "|    total_timesteps      | 1159168      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 2.940942e-05 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.14        |\r\n",
      "|    explained_variance   | -1.51        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00201      |\r\n",
      "|    n_updates            | 5650         |\r\n",
      "|    policy_gradient_loss | 3.05e-05     |\r\n",
      "|    value_loss           | 0.00566      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 20           |\r\n",
      "|    iterations           | 78           |\r\n",
      "|    time_elapsed         | 7931         |\r\n",
      "|    total_timesteps      | 1161216      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0006774965 |\r\n",
      "|    clip_fraction        | 0.000684     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.135       |\r\n",
      "|    explained_variance   | 0.741        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00453     |\r\n",
      "|    n_updates            | 5660         |\r\n",
      "|    policy_gradient_loss | -0.000282    |\r\n",
      "|    value_loss           | 0.000901     |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 20           |\r\n",
      "|    iterations           | 79           |\r\n",
      "|    time_elapsed         | 7936         |\r\n",
      "|    total_timesteps      | 1163264      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0005229441 |\r\n",
      "|    clip_fraction        | 0.00688      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.108       |\r\n",
      "|    explained_variance   | 0.589        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00144     |\r\n",
      "|    n_updates            | 5670         |\r\n",
      "|    policy_gradient_loss | -0.000737    |\r\n",
      "|    value_loss           | 0.00195      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 20           |\r\n",
      "|    iterations           | 80           |\r\n",
      "|    time_elapsed         | 7942         |\r\n",
      "|    total_timesteps      | 1165312      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0005394524 |\r\n",
      "|    clip_fraction        | 0.00669      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0893      |\r\n",
      "|    explained_variance   | 0.452        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | 0.00111      |\r\n",
      "|    n_updates            | 5680         |\r\n",
      "|    policy_gradient_loss | -0.000951    |\r\n",
      "|    value_loss           | 0.00219      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 20           |\r\n",
      "|    iterations           | 81           |\r\n",
      "|    time_elapsed         | 7948         |\r\n",
      "|    total_timesteps      | 1167360      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0001288295 |\r\n",
      "|    clip_fraction        | 0.000342     |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0912      |\r\n",
      "|    explained_variance   | 0.914        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000353    |\r\n",
      "|    n_updates            | 5690         |\r\n",
      "|    policy_gradient_loss | -0.000276    |\r\n",
      "|    value_loss           | 0.00596      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 21           |\r\n",
      "|    iterations           | 82           |\r\n",
      "|    time_elapsed         | 7954         |\r\n",
      "|    total_timesteps      | 1169408      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0003582154 |\r\n",
      "|    clip_fraction        | 0.00483      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.106       |\r\n",
      "|    explained_variance   | 0.839        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00119     |\r\n",
      "|    n_updates            | 5700         |\r\n",
      "|    policy_gradient_loss | -0.000153    |\r\n",
      "|    value_loss           | 0.00267      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 21           |\r\n",
      "|    iterations           | 83           |\r\n",
      "|    time_elapsed         | 7960         |\r\n",
      "|    total_timesteps      | 1171456      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0002227063 |\r\n",
      "|    clip_fraction        | 0            |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.103       |\r\n",
      "|    explained_variance   | 0.44         |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00126     |\r\n",
      "|    n_updates            | 5710         |\r\n",
      "|    policy_gradient_loss | -0.000119    |\r\n",
      "|    value_loss           | 0.00205      |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 21            |\r\n",
      "|    iterations           | 84            |\r\n",
      "|    time_elapsed         | 7965          |\r\n",
      "|    total_timesteps      | 1173504       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00032618814 |\r\n",
      "|    clip_fraction        | 0.00103       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0874       |\r\n",
      "|    explained_variance   | 0.765         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00133      |\r\n",
      "|    n_updates            | 5720          |\r\n",
      "|    policy_gradient_loss | -7.73e-05     |\r\n",
      "|    value_loss           | 0.00274       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 21            |\r\n",
      "|    iterations           | 85            |\r\n",
      "|    time_elapsed         | 7971          |\r\n",
      "|    total_timesteps      | 1175552       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00029644094 |\r\n",
      "|    clip_fraction        | 0.000635      |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.077        |\r\n",
      "|    explained_variance   | -1.67         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.000442      |\r\n",
      "|    n_updates            | 5730          |\r\n",
      "|    policy_gradient_loss | -0.0003       |\r\n",
      "|    value_loss           | 0.00203       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 22            |\r\n",
      "|    iterations           | 86            |\r\n",
      "|    time_elapsed         | 7977          |\r\n",
      "|    total_timesteps      | 1177600       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00022288921 |\r\n",
      "|    clip_fraction        | 0.00366       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0791       |\r\n",
      "|    explained_variance   | 0.399         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00483      |\r\n",
      "|    n_updates            | 5740          |\r\n",
      "|    policy_gradient_loss | -0.000288     |\r\n",
      "|    value_loss           | 0.00166       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 22            |\r\n",
      "|    iterations           | 87            |\r\n",
      "|    time_elapsed         | 7983          |\r\n",
      "|    total_timesteps      | 1179648       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00032465835 |\r\n",
      "|    clip_fraction        | 0.00146       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0872       |\r\n",
      "|    explained_variance   | -0.727        |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.000467     |\r\n",
      "|    n_updates            | 5750          |\r\n",
      "|    policy_gradient_loss | -5.53e-06     |\r\n",
      "|    value_loss           | 0.00339       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 22            |\r\n",
      "|    iterations           | 88            |\r\n",
      "|    time_elapsed         | 7989          |\r\n",
      "|    total_timesteps      | 1181696       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00014941214 |\r\n",
      "|    clip_fraction        | 0             |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.101        |\r\n",
      "|    explained_variance   | 0.191         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.000632     |\r\n",
      "|    n_updates            | 5760          |\r\n",
      "|    policy_gradient_loss | 0.000211      |\r\n",
      "|    value_loss           | 0.00067       |\r\n",
      "-------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 22            |\r\n",
      "|    iterations           | 89            |\r\n",
      "|    time_elapsed         | 7995          |\r\n",
      "|    total_timesteps      | 1183744       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00038614837 |\r\n",
      "|    clip_fraction        | 0.00557       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.109        |\r\n",
      "|    explained_variance   | 0.817         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | 0.0017        |\r\n",
      "|    n_updates            | 5770          |\r\n",
      "|    policy_gradient_loss | -0.000226     |\r\n",
      "|    value_loss           | 0.00342       |\r\n",
      "-------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 90           |\r\n",
      "|    time_elapsed         | 8000         |\r\n",
      "|    total_timesteps      | 1185792      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0006618897 |\r\n",
      "|    clip_fraction        | 0.00889      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.098       |\r\n",
      "|    explained_variance   | -1.04        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00176     |\r\n",
      "|    n_updates            | 5780         |\r\n",
      "|    policy_gradient_loss | -0.000966    |\r\n",
      "|    value_loss           | 0.00179      |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 91           |\r\n",
      "|    time_elapsed         | 8006         |\r\n",
      "|    total_timesteps      | 1187840      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0003080916 |\r\n",
      "|    clip_fraction        | 0.00171      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.102       |\r\n",
      "|    explained_variance   | 0.627        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00129     |\r\n",
      "|    n_updates            | 5790         |\r\n",
      "|    policy_gradient_loss | -0.000117    |\r\n",
      "|    value_loss           | 0.000696     |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 23            |\r\n",
      "|    iterations           | 92            |\r\n",
      "|    time_elapsed         | 8012          |\r\n",
      "|    total_timesteps      | 1189888       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00048888416 |\r\n",
      "|    clip_fraction        | 0.00557       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0944       |\r\n",
      "|    explained_variance   | -2.48         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.000618     |\r\n",
      "|    n_updates            | 5800          |\r\n",
      "|    policy_gradient_loss | -0.000822     |\r\n",
      "|    value_loss           | 0.000632      |\r\n",
      "-------------------------------------------\r\n",
      "-----------------------------------------\r\n",
      "| time/                   |             |\r\n",
      "|    fps                  | 23          |\r\n",
      "|    iterations           | 93          |\r\n",
      "|    time_elapsed         | 8018        |\r\n",
      "|    total_timesteps      | 1191936     |\r\n",
      "| train/                  |             |\r\n",
      "|    approx_kl            | 9.19805e-05 |\r\n",
      "|    clip_fraction        | 0           |\r\n",
      "|    clip_range           | 0.2         |\r\n",
      "|    entropy_loss         | -0.0974     |\r\n",
      "|    explained_variance   | 0.481       |\r\n",
      "|    learning_rate        | 0.0001      |\r\n",
      "|    loss                 | -0.000543   |\r\n",
      "|    n_updates            | 5810        |\r\n",
      "|    policy_gradient_loss | 5.76e-05    |\r\n",
      "|    value_loss           | 0.000646    |\r\n",
      "-----------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 23           |\r\n",
      "|    iterations           | 94           |\r\n",
      "|    time_elapsed         | 8024         |\r\n",
      "|    total_timesteps      | 1193984      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0004246773 |\r\n",
      "|    clip_fraction        | 0.00356      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0877      |\r\n",
      "|    explained_variance   | -1.26        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00408     |\r\n",
      "|    n_updates            | 5820         |\r\n",
      "|    policy_gradient_loss | -0.000477    |\r\n",
      "|    value_loss           | 0.000605     |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 24           |\r\n",
      "|    iterations           | 95           |\r\n",
      "|    time_elapsed         | 8029         |\r\n",
      "|    total_timesteps      | 1196032      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0003331326 |\r\n",
      "|    clip_fraction        | 0.00947      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0964      |\r\n",
      "|    explained_variance   | -1.9         |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.00559     |\r\n",
      "|    n_updates            | 5830         |\r\n",
      "|    policy_gradient_loss | -0.00102     |\r\n",
      "|    value_loss           | 0.000655     |\r\n",
      "------------------------------------------\r\n",
      "------------------------------------------\r\n",
      "| time/                   |              |\r\n",
      "|    fps                  | 24           |\r\n",
      "|    iterations           | 96           |\r\n",
      "|    time_elapsed         | 8035         |\r\n",
      "|    total_timesteps      | 1198080      |\r\n",
      "| train/                  |              |\r\n",
      "|    approx_kl            | 0.0003954404 |\r\n",
      "|    clip_fraction        | 0.00923      |\r\n",
      "|    clip_range           | 0.2          |\r\n",
      "|    entropy_loss         | -0.0825      |\r\n",
      "|    explained_variance   | 0.226        |\r\n",
      "|    learning_rate        | 0.0001       |\r\n",
      "|    loss                 | -0.000468    |\r\n",
      "|    n_updates            | 5840         |\r\n",
      "|    policy_gradient_loss | -0.00112     |\r\n",
      "|    value_loss           | 0.000607     |\r\n",
      "------------------------------------------\r\n",
      "-------------------------------------------\r\n",
      "| time/                   |               |\r\n",
      "|    fps                  | 24            |\r\n",
      "|    iterations           | 97            |\r\n",
      "|    time_elapsed         | 8041          |\r\n",
      "|    total_timesteps      | 1200128       |\r\n",
      "| train/                  |               |\r\n",
      "|    approx_kl            | 0.00029242982 |\r\n",
      "|    clip_fraction        | 0.00415       |\r\n",
      "|    clip_range           | 0.2           |\r\n",
      "|    entropy_loss         | -0.0699       |\r\n",
      "|    explained_variance   | -1.34         |\r\n",
      "|    learning_rate        | 0.0001        |\r\n",
      "|    loss                 | -0.00183      |\r\n",
      "|    n_updates            | 5850          |\r\n",
      "|    policy_gradient_loss | -0.000574     |\r\n",
      "|    value_loss           | 0.000594      |\r\n",
      "-------------------------------------------\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.current_step to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.current_step` for environment variables or `env.get_attr('current_step')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_attr('data')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "/usr/local/lib/python3.10/dist-packages/gymnasium/core.py:297: UserWarning:\r\n",
      "\r\n",
      "\u001b[33mWARN: env.balance to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.balance` for environment variables or `env.get_attr('balance')` that will search the reminding wrappers.\u001b[0m\r\n",
      "\r\n",
      "Running visualizations...\r\n",
      "            timestamp  close  EMA_50  EMA_200\r\n",
      "0 2012-01-01 10:01:00   4.58    4.58     4.58\r\n",
      "1 2012-01-01 10:02:00   4.58    4.58     4.58\r\n",
      "2 2012-01-01 10:03:00   4.58    4.58     4.58\r\n",
      "3 2012-01-01 10:04:00   4.58    4.58     4.58\r\n",
      "4 2012-01-01 10:05:00   4.58    4.58     4.58\r\n",
      "Traceback (most recent call last):\r\n",
      "  File \"/kaggle/working/train6.py\", line 257, in <module>\r\n",
      "    model = train_model(env, val_env, val_data, cleaned_data, model_path, total_timesteps=config[\"total_timesteps\"])\r\n",
      "  File \"/kaggle/working/train6.py\", line 173, in train_model\r\n",
      "    model.learn(\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/ppo/ppo.py\", line 308, in learn\r\n",
      "    return super().learn(\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/on_policy_algorithm.py\", line 259, in learn\r\n",
      "    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/on_policy_algorithm.py\", line 184, in collect_rollouts\r\n",
      "    if callback.on_step() is False:\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/callbacks.py\", line 104, in on_step\r\n",
      "    return self._on_step()\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/callbacks.py\", line 208, in _on_step\r\n",
      "    continue_training = callback.on_step() and continue_training\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/stable_baselines3/common/callbacks.py\", line 104, in on_step\r\n",
      "    return self._on_step()\r\n",
      "  File \"/kaggle/working/train6.py\", line 98, in _on_step\r\n",
      "    validate_model(self.model, self.val_data, self.val_env, self.cleaned_data)\r\n",
      "  File \"/kaggle/working/validate.py\", line 68, in validate_model\r\n",
      "    visualize_data(cleaned_data, save_path=dynamic_save_path, log_to_wandb=True)\r\n",
      "  File \"/kaggle/working/plots.py\", line 162, in visualize_data\r\n",
      "    visualize_with_plotly(data, log_to_wandb=log_to_wandb)\r\n",
      "  File \"/kaggle/working/plots.py\", line 35, in visualize_with_plotly\r\n",
      "    wandb.log({\"BTC Price with EMAs (Plotly)\": wandb.data_types.Plotly(fig)})\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/wandb/sdk/data_types/plotly.py\", line 72, in __init__\r\n",
      "    util.json_dump_safer(val, fp)\r\n",
      "  File \"/usr/local/lib/python3.10/dist-packages/wandb/util.py\", line 798, in json_dump_safer\r\n",
      "    return dump(obj, fp, cls=WandBJSONEncoder, **kwargs)\r\n",
      "  File \"/usr/lib/python3.10/json/__init__.py\", line 180, in dump\r\n",
      "    fp.write(chunk)\r\n",
      "  File \"/usr/lib/python3.10/codecs.py\", line 721, in write\r\n",
      "    return self.writer.write(data)\r\n",
      "  File \"/usr/lib/python3.10/codecs.py\", line 378, in write\r\n",
      "    self.stream.write(data)\r\n",
      "KeyboardInterrupt\r\n"
     ]
    }
   ],
   "source": [
    "!python train6.py"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 1346,
     "sourceId": 10351585,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 6410462,
     "sourceId": 10358955,
     "sourceType": "datasetVersion"
    },
    {
     "modelId": 206687,
     "modelInstanceId": 184527,
     "sourceId": 216436,
     "sourceType": "modelInstanceVersion"
    }
   ],
   "dockerImageVersionId": 30823,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 10644.297443,
   "end_time": "2025-01-03T03:22:18.423219",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-01-03T00:24:54.125776",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
